<!DOCTYPE html>
<html>
<head>
  <title>Script Loader + Folder File Lister</title>
  <HTA:APPLICATION
    APPLICATIONNAME="ScriptFolderTool"
    BORDER="thin"
    SCROLL="no"
    SINGLEINSTANCE="yes"
    WINDOWSTATE="maximize"
  />
  <meta name="author" content="John Core">
  <meta name="program" content="Scriptquickie">
  <meta name="purpose" content="Easy script launching, testing, and editing environment">
  <meta name="description" content="Scriptquickie is a lightweight HTA-based tool for loading, editing, and executing PowerShell scripts with ease.">
  <meta name="version" content="1.0">
  <meta name="created" content="2025-08-09">

  <style>
    body {
      font-family: Segoe UI, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to right, #cce5ff, #e6f2ff);
    }

    .header {
      background-color: #003366;
      color: white;
      padding: 20px;
      text-align: center;
    }

    .header h1 {
      margin: 0;
      font-size: 2em;
    }

    .header p {
      margin: 5px 0;
    }

    table {
      width: 100%;
      height: calc(100vh - 120px);
      table-layout: fixed;
      background-color: #ffffff;
    }

    td {
      vertical-align: top;
      padding: 20px;
      border-right: 1px solid #ccc;
    }

    textarea {
      width: 100%;
      height: 400px;
      font-family: Consolas, monospace;
      white-space: pre;
      resize: none;
      border: 1px solid #ccc;
      padding: 10px;
      background-color: #f9f9f9;
    }

    input[type="text"] {
      width: 100%;
      margin-bottom: 10px;
      padding: 8px;
      border: 1px solid #ccc;
    }

    button {
      background-color: #007acc;
      color: white;
      border: none;
      padding: 8px 12px;
      margin-right: 10px;
      margin-top: 5px;
      cursor: pointer;
      border-radius: 4px;
    }

    button:hover {
      background-color: #005f99;
    }
  </style>

  <script language="javascript">
    function loadScript() {
      var filePath = document.getElementById("filePath").value;
      try {
        var fso = new ActiveXObject("Scripting.FileSystemObject");
        if (fso.FileExists(filePath)) {
          var file = fso.OpenTextFile(filePath, 1);
          var content = file.ReadAll();
          file.Close();
          document.getElementById("scriptContent").value = content;
        } else {
          alert("File not found:\n" + filePath);
        }
      } catch (e) {
        alert("Error loading file:\n" + e.message);
      }
    }

    function runScript() {
      var script = document.getElementById("scriptContent").value;
      try {
        var shell = new ActiveXObject("Shell.Application");
        var fso = new ActiveXObject("Scripting.FileSystemObject");
        var tempFolder = fso.GetSpecialFolder(2);
        var tempPath = tempFolder + "\\temp_script.ps1";

        script += '\nWrite-Host "`nScript complete. Press any key to close this window..." -ForegroundColor Yellow';
        script += '\n$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")';

        var file = fso.CreateTextFile(tempPath, true);
        file.Write(script);
        file.Close();

        var command = "-ExecutionPolicy Bypass -File \"" + tempPath + "\"";
        shell.ShellExecute("powershell.exe", command, "", "runas", 1);
      } catch (e) {
        alert("Error running script:\n" + e.message);
      }
    }

    function saveScript() {
      var filePath = document.getElementById("filePath").value;
      var script = document.getElementById("scriptContent").value;
      try {
        var fso = new ActiveXObject("Scripting.FileSystemObject");
        var file = fso.CreateTextFile(filePath, true);
        file.Write(script);
        file.Close();
        alert("Script saved to:\n" + filePath);
      } catch (e) {
        alert("Error saving script:\n" + e.message);
      }
    }

    function SelectFolder() {
      try {
        var shell = new ActiveXObject("Shell.Application");
        var folder = shell.BrowseForFolder(0, "Select a folder", 0);
        if (folder) {
          var path = folder.Items().Item().Path;
          document.getElementById("folderPath").value = path;
          document.getElementById("filePath").value = path;
          listFiles(path);
        }
      } catch (e) {
        alert("Folder Selecter not available:\n" + e.message);
      }
    }

    function listFiles(folderPath) {
      try {
        var fso = new ActiveXObject("Scripting.FileSystemObject");
        var folder = fso.GetFolder(folderPath);
        var files = new Enumerator(folder.Files);
        var output = "";

        for (; !files.atEnd(); files.moveNext()) {
          output += files.item().Name + "\n";
        }

        document.getElementById("fileList").value = output;
      } catch (e) {
        alert("Error listing files:\n" + e.message);
      }
    }

    function runFile(filePath) {
      try {
        var shell = new ActiveXObject("Shell.Application");
        shell.ShellExecute(filePath, "", "", "runas", 1);
      } catch (e) {
        alert("Error launching file:\n" + e.message);
      }
    }

    function openFolderLocation() {
      var folderPath = document.getElementById("folderPath").value;
      if (folderPath) {
        try {
          var shell = new ActiveXObject("Shell.Application");
          shell.ShellExecute("explorer.exe", '"' + folderPath + '"', "", "open", 1);
        } catch (e) {
          alert("Error opening folder:\n" + e.message);
        }
      } else {
        alert("No folder path selected.");
      }
    }

    function launchFixedScript() {
      var filePath = "C:\\Scripts\\PSscriptLauncher.ps1";
      try {
        var fso = new ActiveXObject("Scripting.FileSystemObject");
        if (fso.FileExists(filePath)) {
          var shell = new ActiveXObject("Shell.Application");
          var command = "-ExecutionPolicy Bypass -File \"" + filePath + "\"";
          shell.ShellExecute("powershell.exe", command, "", "runas", 1);
        } else {
          alert("Script not found:\n" + filePath);
        }
      } catch (e) {
        alert("Error launching script:\n" + e.message);
      }
    }
  </script>
</head>

<body>
  <div class="header">
  <h1>Scriptquickie</h1>
  <p>Easy script launching, testing, and editing environment</p>
  <small>Created by John Core<br>Version 1.0 - August 9, 2025</small>
</div>


  <table>
    <tr>
      <!-- Left Panel: Script Loader -->
      <td width="50%">
        <h3>Script Loader</h3>
        <input type="text" id="filePath" placeholder="Enter full path to .ps1 file or folder">
        <br>
        <button onclick="loadScript()">Load Script</button>
        <br><br>
        <textarea id="scriptContent" placeholder="Script content will appear here..."></textarea>
        <br><br>
        <button onclick="runScript()">Run PSscript Only</button>
        <button onclick="saveScript()">Save Changes</button>
        <button onclick="runFile(document.getElementById('filePath').value)">Run File</button>
      </td>

      <!-- Right Panel: Folder File Lister -->
      <td width="50%">
        <h3>Folder Path</h3>
        <input type="text" id="folderPath" placeholder="Selected folder path will appear here">
        <br>
        <button onclick="SelectFolder()">Select Folder</button>
        <button onclick="openFolderLocation()">Open Folder in Explorer</button>
        <button onclick="launchFixedScript()">Locate and Launch PowerShell File</button>
        <br><br>
        <textarea id="fileList" placeholder="Files in the selected folder will appear here..."></textarea>
      </td>
    </tr>
  </table>
</body>
</html>
